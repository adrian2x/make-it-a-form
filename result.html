<!DOCTYPE html>
<html>
  <head>
    <title>Form Builder Elements</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="fonts/icon/style.css" rel="stylesheet">
    <link href="ext/datetimepicker/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <link href="ext/spinedit/bootstrap-spinedit.css" rel="stylesheet">
      <link href='http://fonts.googleapis.com/css?family=Roboto:400,300' rel='stylesheet' type='text/css'>
    <script src="js/functions.js"></script>
  </head>
  <body>
    <div class="container">

      <div class="sidebar col-sm-2">
        <div class="title"><h4>Form Elements </h4></div>
        <ul>

          <li id="textField"
            data-markup='
            <div class="form-group" data-modal="#textFieldModal">
              <input type="text" class="form-control" id="exampleInput" placeholder="Answer">
            </div>'>
            <span class="glyphicon glyphicon-font"></span> Question</li>

          <li id="nameField" 
            data-markup='
              <div class="form-group">
                <div class="form-inline">
                  <div class="form-group">
                    <input type="text" class="form-control" id="firstName" placeholder="First">
                  </div>
                  <div class="form-group">
                    <input type="text" class="form-control" id="middleName" placeholder="Middle">
                  </div>
                  <div class="form-group">
                    <input type="text" class="form-control" id="lastName" placeholder="Last">
                  </div>
                </div>
              </div>'>
            <span class="glyphicon glyphicon-user"></span> Name
          </li>

          <li id="phoneField"
            data-markup='
              <div class="form-group">
                <input type="tel" class="form-control" id="examplePhone" placeholder="(888)-888-8888">
              </div>'>
            <span class="icon icon-phone"></span> Phone
          </li>

          <li id="textAreaField" 
            data-markup='
              <div class="form-group">
                <div class="form-group">
                  <input type="text" class="form-control" id="streetAddress" placeholder="Street Address">
                </div>
                <div class="form-group">
                  <input type="text" class="form-control" id="streetAddress2" placeholder="Street Address Line 2">
                </div>
                <div class="form-inline">
                  <div class="form-group">
                    <input type="text" class="form-control" id="cityAddress" placeholder="City">
                  </div>
                  <div class="form-group">
                    <input type="text" class="form-control" id="stateAddress" placeholder="State">
                  </div>
                  <div class="form-group">
                    <input type="text" class="form-control" id="zipAddress" placeholder="Zip">
                  </div>
                </div>
              </div>'>
              <span class="icon icon-address-book"></span> Address</li>

          <li id="emailField" 
            data-markup='
              <div class="form-group">
                <input type="email" class="form-control" id="exampleEmail" placeholder="name@domain.com">
              </div>'>
            <span class="icon icon-envelope"></span> Email
          </li>

          <li id="radioField" 
            data-markup='
              <div class="form-group">
                <div class="radio">
                  <input type="radio" name="radios" value=""> Option 1
                </div>
                <div class="radio">
                    <input type="radio" name="radios" value=""> Option 2
                </div>
                <div class="radio">
                    <input type="radio" name="radios" value=""> Option 3
                </div>
              </div>'>
            <span class="icon icon-radio-checked"></span> Radio Buttons
          </li>

          <li id="checkBoxField" 
            data-markup='
              <div class="form-group">
                <div class="checkbox">
                  <input type="checkbox" value=""> Option 1
                </div>
                <div class="checkbox">
                  <input type="checkbox" value=""> Option 2
                </div>
                <div class="checkbox">
                  <input type="checkbox" value=""> Option 3
                </div>
              </div>'>
            <span class="icon icon-checkbox-checked"></span> Check Boxes
          </li>

          <li id="fileUploadField"
            data-markup='
              <div class="form-group">
                <input type="file" id="exampleInputFile">
              </div>'>
            <span class="icon icon-file"></span> File upload
          </li>

          <li id="datePickerField" 
            data-markup='
              <div class="form-group" data-initialize="makeDatepicker">
                <div class="datepicker input-group col-md-4">
                  <input class="form-control" type="text">
                  <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                </div>
              </div>'>
            <span class="icon icon-calendar"></span> Date picker
          </li>

          <li id="timePickerField" 
            data-markup='
              <div class="form-group" data-initialize="makeTimepicker">
                <div class="timepicker input-group col-md-4">
                  <input class="form-control" type="text">
                  <span class="input-group-addon"><span class="glyphicon glyphicon-time"></span></span>
                </div>
              </div>'>
            <span class="icon icon-clock"></span> Time picker
          </li>

          <li id="numberField"
            data-markup='
              <div class="form-group" data-initialize="makeSpinedit">
                <input type="text" class="form-control numeric-spinner" placeholder="0">
              </div>'>
            <span class="glyphicon glyphicon-usd"></span> Number
          </li>

          <li id="buttonField"
            data-markup='
              <div class="form-group">
                <button type="submit" class="btn btn-primary">Submit</button>
              </div>'>
            <span class="glyphicon glyphicon-hand-up"></span> Submit
          </li>

        </ul>
          <button class="btn btn-primary" id="generateIt">Generate it</button>
      </div>

      <div class="col-sm-3 properties-panel">
        <div class="title"><h4>Add properties <span class="label label-default">new</span></h4></div>
        <div class="area">
          <section>
            <div class="form-group">
              <div class="radio">
                <label>
                  <input type="radio" name="answer-radio" id="add-short-answer"
                    onclick="addToDesign(this)"
                    data-markup='
                      <div class="form-group">
                        <input type="text" class="form-control" id="exampleInput" placeholder="Answer">
                      </div>'> Short Answer
                </label>
              </div>
              <div class="radio">
                <label>
                  <input type="radio" name="answer-radio" id="add-long-answer"
                    onclick="addToDesign(this)"
                    data-markup='
                      <div class="form-group" data-modal="#textFieldModal">
                        <textarea class="form-control" id="exampleInput" placeholder="Answer"></textarea>
                      </div>'> Long Answer
                </label>
              </div>
            </div>
          </section>
          <section id="answer-question">
            <div class="form-group">
              <input type="text" class="form-control" placeholder="Question">
            </div>
            <div class="form-group">
              <input type="text" class="form-control" placeholder="Hint">
            </div>
          </section>
        </div>
      </div>

      <div class="design-area col-md-8">
        <h4>Preview</h4>
        <ul id="sortable"> 

        </ul>
      </div>



      </div>
    
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/datepicker/js/bootstrap-datepicker.js"></script>
    <script src="js/timepicker/timepicker.min.js"></script>
    <script src="ext/moment/moment.min.js"></script>
    <script src="ext/datetimepicker/bootstrap-datetimepicker.min.js"></script>
    <script src="ext/spinedit/bootstrap-spinedit.js"></script>

    <script type="text/javascript">
      var dragging = false;

      

      $(window).ready(function() {

        // hide the properties panel
        $(".sidebar ul li").click(function() {
          $(".properties-panel").toggleClass("properties-panel-visible");
          $(this).toggleClass("sidebar-menu-active");
        });

        // initialize sortable
        (function initSortable() {
          $("ul#sortable").sortable({
            axis: "y",
            delay: 150,
            cursor: "move",
            opacity: 0.6,
            placeholder: 'ui-state-sorting',
            update: function(event, ui) {
              if(dragging) {
                markup = ui.item.data('markup');
                $el = initializeComponent($(markup)).css("opacity", 0);
                $el.insertBefore(ui.item).hide().animate({height: 'toggle', opacity: 1}, 250);
                ui.item.remove();
              }
            }
          });
        })();

        $("ul#sortable").disableSelection();

        $(".sidebar>ul li").draggable({

          // helper: function(e) {
          //   return $(this).data("markup");
          // }, 
          helper: "clone",
          revert: "invalid",
          connectToSortable: "ul#sortable",
          start: function() {
            dragging = true;
          },
          stop: function() {
            dragging = false;
          }
        });

        // add tooltips
        $(".has-tooltip").tooltip({
          delay: {show: 600, hide: 100},
        });
          
          $("#generateIt").click(function(){
              var elements = [];
              $("#sortable").find(".component").each(function(el, val){
                  var head = $('<li class="component">');
                  console.log(val);
                  $(val).children().each(function(key, value){
                      value = $(value);
                      if(value.hasClass('editable')) {
                          var some = value.children('input');
                          var $helper = $('<h3>').text(some.val());
                          
                          if(some.hasClass('help-block'))
                              $helper = $('<h4 class="help-block">').text(some.val());
                          
                          head.append($helper);
                      }
                      else if(value.hasClass('form-group')) {
                          head.append(value);
                      }
                  });
                  elements.push(head);
              });
              
              $("#sortable").after($('<ul id="sortable">').append(elements));
          });

      });
    </script>
  </body>
</html>